"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.deployerRoleArns = exports.lambdaDatadogApiKeySecretArn = exports.datadogLambdaName = exports.accountResourcePrefix = exports.wesDigitalEnv = exports.publicHostedZone = exports.wesDigitalVpc = exports.AvailabilityZones = exports.RegionAbbreviation = exports.AwsAccounts = exports.DatadogImageTag = exports.DatadogImage = exports.DeploymentRegion = exports.WesdigitalAccount = void 0;
const aws_ec2_1 = require("aws-cdk-lib/aws-ec2");
const aws_cdk_lib_1 = require("aws-cdk-lib");
const aws_route53_1 = require("aws-cdk-lib/aws-route53");
var WesdigitalAccount;
(function (WesdigitalAccount) {
    // eslint-disable-next-line no-unused-vars
    WesdigitalAccount["AdvantagePlatformSandpit"] = "765018113112";
    // eslint-disable-next-line no-unused-vars
    WesdigitalAccount["AdvantageAppSandpit"] = "317585435641";
    // eslint-disable-next-line no-unused-vars
    WesdigitalAccount["AdvantageAppNonProd"] = "348279902832";
    // eslint-disable-next-line no-unused-vars
    WesdigitalAccount["AdvantageAppProd"] = "554417847584";
    // eslint-disable-next-line no-unused-vars
    WesdigitalAccount["CICDTooling"] = "345954686127";
})(WesdigitalAccount = exports.WesdigitalAccount || (exports.WesdigitalAccount = {}));
exports.DeploymentRegion = 'ap-southeast-2';
exports.DatadogImage = 'datadog-agent';
exports.DatadogImageTag = '7';
exports.AwsAccounts = new Map([
    [
        WesdigitalAccount.AdvantagePlatformSandpit,
        {
            envConfigs: new Map([
                [
                    'dev',
                    {
                        ecrAccount: WesdigitalAccount.CICDTooling,
                        internalLb: 'platform.internal.advpltfrm-sp.wesdigital.com.au',
                        privateSubnetIds: ['subnet-0fd990d9f59dc5f6f', 'subnet-053965b47d6971256', 'subnet-0120b8fccb24ab30c'],
                        vpcId: 'vpc-081f32b1e62eb3b9f',
                        mskClusterArn: 'arn:aws:kafka:ap-southeast-2:765018113112:cluster/adv-msk-dev/83676320-6db0-490a-bb8f-da4ac5fc5914-2',
                        mskClusterName: 'adv-msk-dev',
                        lambdaDatadogApiKeySecretArn: 'arn:aws:secretsmanager:ap-southeast-2:765018113112:secret:/dev/platform/datadog_lambda-uC5k3n',
                        publicHostedZoneAttrs: {
                            hostedZoneId: 'Z0318864Z94P954L5ZH8',
                            zoneName: 'platform.onepass.com.au'
                        }
                    }
                ]
            ]),
            resourcePrefix: 'advantage-platform-sandpit'
        }
    ],
    [
        WesdigitalAccount.AdvantageAppSandpit,
        {
            envConfigs: new Map([
                [
                    'dev',
                    {
                        ecrAccount: WesdigitalAccount.CICDTooling,
                        internalLb: 'internal.dev.onepass.com.au',
                        privateSubnetIds: ['subnet-02a0efb50ec7e1dde', 'subnet-09079df43da1626f0', 'subnet-0ec97ec0250420617'],
                        vpcId: 'vpc-02f67ef89d3e6e002',
                        mskClusterArn: 'arn:aws:kafka:ap-southeast-2:317585435641:cluster/adv-msk-dev/0dbbbca3-19d4-410f-b580-a1b95ce11c53-2',
                        mskClusterName: 'adv-msk-dev',
                        lambdaDatadogApiKeySecretArn: 'arn:aws:secretsmanager:ap-southeast-2:317585435641:secret:/dev/platform/datadog_lambda-kUxLWu',
                        publicHostedZoneAttrs: {
                            hostedZoneId: 'Z0225803376F1OMLW5SSO',
                            zoneName: 'dev.onepass.com.au'
                        },
                        benefits: {
                            eventBusName: 'dev-benefits'
                        }
                    }
                ]
            ]),
            resourcePrefix: 'advantage-app-sandpit'
        }
    ],
    [
        WesdigitalAccount.AdvantageAppNonProd,
        {
            envConfigs: new Map([
                [
                    'test',
                    {
                        ecrAccount: WesdigitalAccount.CICDTooling,
                        internalLb: 'internal.test.onepass.com.au',
                        privateSubnetIds: ['subnet-0e07fcaf58970e908', 'subnet-0d03d8d4764cb2567', 'subnet-07f2c8adb6b229814'],
                        vpcId: 'vpc-03b87594ddc2c6fea',
                        mskClusterArn: 'arn:aws:kafka:ap-southeast-2:348279902832:cluster/adv-msk-test/ba6f57d8-4422-469c-9fcf-11ac5b9fca9c-2',
                        mskClusterName: 'adv-msk-test',
                        lambdaDatadogApiKeySecretArn: 'arn:aws:secretsmanager:ap-southeast-2:348279902832:secret:/test/platform/datadog_lambda-zAGK1p',
                        publicHostedZoneAttrs: {
                            hostedZoneId: 'Z0592373125Y5H3VS5GSN',
                            zoneName: 'test.onepass.com.au'
                        },
                        benefits: {
                            eventBusName: 'test-benefits'
                        }
                    }
                ],
                [
                    'sit',
                    {
                        ecrAccount: WesdigitalAccount.CICDTooling,
                        internalLb: 'internal.sit.onepass.com.au',
                        privateSubnetIds: ['subnet-0e07fcaf58970e908', 'subnet-0d03d8d4764cb2567', 'subnet-07f2c8adb6b229814'],
                        vpcId: 'vpc-03b87594ddc2c6fea',
                        mskClusterArn: 'arn:aws:kafka:ap-southeast-2:348279902832:cluster/adv-msk-sit/a33d3245-1480-4f88-bd2f-592a437c8a52-2',
                        mskClusterName: 'adv-msk-sit',
                        lambdaDatadogApiKeySecretArn: 'arn:aws:secretsmanager:ap-southeast-2:348279902832:secret:/sit/platform/datadog_lambda-aJU69K',
                        publicHostedZoneAttrs: {
                            hostedZoneId: 'Z05914803KXTQOVTXYEE5',
                            zoneName: 'sit.onepass.com.au'
                        },
                        benefits: {
                            eventBusName: 'sit-benefits'
                        }
                    }
                ]
            ]),
            resourcePrefix: 'advantage-app-nonprod'
        }
    ],
    [
        WesdigitalAccount.AdvantageAppProd,
        {
            envConfigs: new Map([
                [
                    'prod',
                    {
                        ecrAccount: WesdigitalAccount.CICDTooling,
                        internalLb: 'internal.onepass.com.au',
                        privateSubnetIds: ['subnet-07aa0df7dbba041f1', 'subnet-0321de13bcc87a714', 'subnet-0f5f69f728b5bc932'],
                        vpcId: 'vpc-08401dd69c3f2b410',
                        mskClusterArn: 'arn:aws:kafka:ap-southeast-2:554417847584:cluster/adv-msk-prod/bc284581-7e09-45f1-9f82-c725834799f7-2',
                        mskClusterName: 'adv-msk-prod',
                        lambdaDatadogApiKeySecretArn: 'arn:aws:secretsmanager:ap-southeast-2:554417847584:secret:/prod/platform/datadog_lambda-S0v5Ri',
                        publicHostedZoneAttrs: {
                            hostedZoneId: 'Z014106223ORU48WQ3Y21',
                            zoneName: 'onepass.com.au'
                        },
                        benefits: {
                            eventBusName: 'prod-benefits'
                        }
                    }
                ]
            ]),
            resourcePrefix: 'advantage-app-prod'
        }
    ]
]);
exports.RegionAbbreviation = {
    'ap-southeast-2': 'apse2'
};
exports.AvailabilityZones = {
    'ap-southeast-2': ['ap-southeast-2a', 'ap-southeast-2b', 'ap-southeast-2c']
};
const wesDigitalVpc = (scope, id, props) => {
    const env = (0, exports.wesDigitalEnv)(props);
    return aws_ec2_1.Vpc.fromVpcAttributes(scope, id, {
        vpcId: env.vpcId,
        availabilityZones: exports.AvailabilityZones[exports.DeploymentRegion],
        privateSubnetIds: env.privateSubnetIds
    });
};
exports.wesDigitalVpc = wesDigitalVpc;
const publicHostedZone = (scope, id, props) => {
    const env = (0, exports.wesDigitalEnv)(props);
    return aws_route53_1.HostedZone.fromHostedZoneAttributes(scope, id, env.publicHostedZoneAttrs);
};
exports.publicHostedZone = publicHostedZone;
const wesDigitalEnv = (props) => {
    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion
    return exports.AwsAccounts.get(props.account).envConfigs.get(props.env);
};
exports.wesDigitalEnv = wesDigitalEnv;
const accountResourcePrefix = (accountNumber) => {
    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion
    return exports.AwsAccounts.get(accountNumber).resourcePrefix;
};
exports.accountResourcePrefix = accountResourcePrefix;
const datadogLambdaName = (accountNumber) => {
    return `${(0, exports.accountResourcePrefix)(accountNumber)}-${exports.RegionAbbreviation[exports.DeploymentRegion]}-datadog-forwarder`;
};
exports.datadogLambdaName = datadogLambdaName;
const lambdaDatadogApiKeySecretArn = (props) => {
    return exports.AwsAccounts.get(props.account).envConfigs.get(props.env).lambdaDatadogApiKeySecretArn;
};
exports.lambdaDatadogApiKeySecretArn = lambdaDatadogApiKeySecretArn;
const deployerRoleArns = (scope) => {
    const account = aws_cdk_lib_1.Stack.of(scope).account;
    return [
        `arn:aws:iam::${account}:role/data-crossaccount-deployer`,
        `arn:aws:iam::${account}:role/application-crossaccount-deployer`,
        `arn:aws:iam::${account}:role/data-infrastructure-crossaccount-deployer`,
        `arn:aws:iam::${account}:role/infra-crossaccount-deployer`
    ];
};
exports.deployerRoleArns = deployerRoleArns;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWNjb3VudHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9saWIvd2VzZGlnaXRhbC9hY2NvdW50cy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFDQSxpREFBK0M7QUFDL0MsNkNBQW1DO0FBQ25DLHlEQUF1RjtBQUl2RixJQUFZLGlCQVdYO0FBWEQsV0FBWSxpQkFBaUI7SUFDekIsMENBQTBDO0lBQzFDLDhEQUF5QyxDQUFBO0lBQ3pDLDBDQUEwQztJQUMxQyx5REFBb0MsQ0FBQTtJQUNwQywwQ0FBMEM7SUFDMUMseURBQW9DLENBQUE7SUFDcEMsMENBQTBDO0lBQzFDLHNEQUFpQyxDQUFBO0lBQ2pDLDBDQUEwQztJQUMxQyxpREFBNEIsQ0FBQTtBQUNoQyxDQUFDLEVBWFcsaUJBQWlCLEdBQWpCLHlCQUFpQixLQUFqQix5QkFBaUIsUUFXNUI7QUE0QlksUUFBQSxnQkFBZ0IsR0FBRyxnQkFBZ0IsQ0FBQTtBQUVuQyxRQUFBLFlBQVksR0FBRyxlQUFlLENBQUE7QUFFOUIsUUFBQSxlQUFlLEdBQUcsR0FBRyxDQUFBO0FBRXJCLFFBQUEsV0FBVyxHQUFpRCxJQUFJLEdBQUcsQ0FBQztJQUM3RTtRQUNJLGlCQUFpQixDQUFDLHdCQUF3QjtRQUMxQztZQUNJLFVBQVUsRUFBRSxJQUFJLEdBQUcsQ0FBQztnQkFDaEI7b0JBQ0ksS0FBSztvQkFDTDt3QkFDSSxVQUFVLEVBQUUsaUJBQWlCLENBQUMsV0FBVzt3QkFDekMsVUFBVSxFQUFFLGtEQUFrRDt3QkFDOUQsZ0JBQWdCLEVBQUUsQ0FBQywwQkFBMEIsRUFBRSwwQkFBMEIsRUFBRSwwQkFBMEIsQ0FBQzt3QkFDdEcsS0FBSyxFQUFFLHVCQUF1Qjt3QkFDOUIsYUFBYSxFQUFFLHNHQUFzRzt3QkFDckgsY0FBYyxFQUFFLGFBQWE7d0JBQzdCLDRCQUE0QixFQUFFLCtGQUErRjt3QkFDN0gscUJBQXFCLEVBQUU7NEJBQ25CLFlBQVksRUFBRSxzQkFBc0I7NEJBQ3BDLFFBQVEsRUFB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c3RydWN0IH0gZnJvbSAnY29uc3RydWN0cydcbmltcG9ydCB7IElWcGMsIFZwYyB9IGZyb20gJ2F3cy1jZGstbGliL2F3cy1lYzInXG5pbXBvcnQgeyBTdGFjayB9IGZyb20gJ2F3cy1jZGstbGliJ1xuaW1wb3J0IHsgSG9zdGVkWm9uZSwgSG9zdGVkWm9uZUF0dHJpYnV0ZXMsIElIb3N0ZWRab25lIH0gZnJvbSAnYXdzLWNkay1saWIvYXdzLXJvdXRlNTMnXG5cbmV4cG9ydCB0eXBlIERlcGxveW1lbnRFbnYgPSAnZGV2JyB8ICd0ZXN0JyB8ICdzaXQnIHwgJ3Byb2QnXG5cbmV4cG9ydCBlbnVtIFdlc2RpZ2l0YWxBY2NvdW50IHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgICBBZHZhbnRhZ2VQbGF0Zm9ybVNhbmRwaXQgPSAnNzY1MDE4MTEzMTEyJyxcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgICBBZHZhbnRhZ2VBcHBTYW5kcGl0ID0gJzMxNzU4NTQzNTY0MScsXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC12YXJzXG4gICAgQWR2YW50YWdlQXBwTm9uUHJvZCA9ICczNDgyNzk5MDI4MzInLFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtdmFyc1xuICAgIEFkdmFudGFnZUFwcFByb2QgPSAnNTU0NDE3ODQ3NTg0JyxcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgICBDSUNEVG9vbGluZyA9ICczNDU5NTQ2ODYxMjcnXG59XG5cbmV4cG9ydCB0eXBlIFdlc2RpZ2l0YWxBY2NvdW50TnVtYmVyID0gYCR7V2VzZGlnaXRhbEFjY291bnR9YFxuXG5leHBvcnQgaW50ZXJmYWNlIEFjY291bnRDb25maWcge1xuICAgIGVjckFjY291bnQ6IHN0cmluZ1xuICAgIGludGVybmFsTGI6IHN0cmluZ1xuICAgIHZwY0lkOiBzdHJpbmdcbiAgICBwcml2YXRlU3VibmV0SWRzOiBzdHJpbmdbXVxuICAgIG1za0NsdXN0ZXJBcm46IHN0cmluZ1xuICAgIG1za0NsdXN0ZXJOYW1lOiBzdHJpbmdcbiAgICBsYW1iZGFEYXRhZG9nQXBpS2V5U2VjcmV0QXJuOiBzdHJpbmdcbiAgICBwdWJsaWNIb3N0ZWRab25lQXR0cnM6IEhvc3RlZFpvbmVBdHRyaWJ1dGVzXG4gICAgYmVuZWZpdHM/OiB7XG4gICAgICAgIGV2ZW50QnVzTmFtZTogc3RyaW5nLFxuICAgIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBBY2NvdW50RGV0YWlscyB7XG4gICAgcmVzb3VyY2VQcmVmaXg6IHN0cmluZ1xuICAgIGVudkNvbmZpZ3M6IE1hcDxEZXBsb3ltZW50RW52LCBBY2NvdW50Q29uZmlnPlxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEVudlByb3Bze1xuICAgIGFjY291bnQ6IFdlc2RpZ2l0YWxBY2NvdW50TnVtYmVyXG4gICAgZW52OiBEZXBsb3ltZW50RW52XG59XG5cbmV4cG9ydCBjb25zdCBEZXBsb3ltZW50UmVnaW9uID0gJ2FwLXNvdXRoZWFzdC0yJ1xuXG5leHBvcnQgY29uc3QgRGF0YWRvZ0ltYWdlID0gJ2RhdGFkb2ctYWdlbnQnXG5cbmV4cG9ydCBjb25zdCBEYXRhZG9nSW1hZ2VUYWcgPSAnNydcblxuZXhwb3J0IGNvbnN0IEF3c0FjY291bnRzOiBNYXA8V2VzZGlnaXRhbEFjY291bnROdW1iZXIsIEFjY291bnREZXRhaWxzPiA9IG5ldyBNYXAoW1xuICAgIFtcbiAgICAgICAgV2VzZGlnaXRhbEFjY291bnQuQWR2YW50YWdlUGxhdGZvcm1TYW5kcGl0LFxuICAgICAgICB7XG4gICAgICAgICAgICBlbnZDb25maWdzOiBuZXcgTWFwKFtcbiAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICdkZXYnLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlY3JBY2NvdW50OiBXZXNkaWdpdGFsQWNjb3VudC5DSUNEVG9vbGluZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGludGVybmFsTGI6ICdwbGF0Zm9ybS5pbnRlcm5hbC5hZHZwbHRmcm0tc3Aud2VzZGlnaXRhbC5jb20uYXUnLCAvLyBUaGlzIHdpbGwgbmVlZCB1cGRhdGluZyB3aGVuIHBsYXRmb3JtIHRlYW0gdXBkYXRlcyBpdHMgaG9zdGVkIHpvbmVcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaXZhdGVTdWJuZXRJZHM6IFsnc3VibmV0LTBmZDk5MGQ5ZjU5ZGM1ZjZmJywgJ3N1Ym5ldC0wNTM5NjViNDdkNjk3MTI1NicsICdzdWJuZXQtMDEyMGI4ZmNjYjI0YWIzMGMnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZwY0lkOiAndnBjLTA4MWYzMmIxZTYyZWIzYjlmJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1za0NsdXN0ZXJBcm46ICdhcm46YXdzOmthZmthOmFwLXNvdXRoZWFzdC0yOjc2NTAxODExMzExMjpjbHVzdGVyL2Fkdi1tc2stZGV2LzgzNjc2MzIwLTZkYjAtNDkwYS1iYjhmLWRhNGFjNWZjNTkxNC0yJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1za0NsdXN0ZXJOYW1lOiAnYWR2LW1zay1kZXYnLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGFtYmRhRGF0YWRvZ0FwaUtleVNlY3JldEFybjogJ2Fybjphd3M6c2VjcmV0c21hbmFnZXI6YXAtc291dGhlYXN0LTI6NzY1MDE4MTEzMTEyOnNlY3JldDovZGV2L3BsYXRmb3JtL2RhdGFkb2dfbGFtYmRhLXVDNWszbicsXG4gICAgICAgICAgICAgICAgICAgICAgICBwdWJsaWNIb3N0ZWRab25lQXR0cnM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBob3N0ZWRab25lSWQ6ICdaMDMxODg2NFo5NFA5NTRMNVpIOCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgem9uZU5hbWU6ICdwbGF0Zm9ybS5vbmVwYXNzLmNvbS5hdSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgIF0pLFxuICAgICAgICAgICAgcmVzb3VyY2VQcmVmaXg6ICdhZHZhbnRhZ2UtcGxhdGZvcm0tc2FuZHBpdCdcbiAgICAgICAgfVxuICAgIF0sXG4gICAgW1xuICAgICAgICBXZXNkaWdpdGFsQWNjb3VudC5BZHZhbnRhZ2VBcHBTYW5kcGl0LFxuICAgICAgICB7XG4gICAgICAgICAgICBlbnZDb25maWdzOiBuZXcgTWFwKFtcbiAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICdkZXYnLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlY3JBY2NvdW50OiBXZXNkaWdpdGFsQWNjb3VudC5DSUNEVG9vbGluZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGludGVybmFsTGI6ICdpbnRlcm5hbC5kZXYub25lcGFzcy5jb20uYXUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJpdmF0ZVN1Ym5ldElkczogWydzdWJuZXQtMDJhMGVmYjUwZWM3ZTFkZGUnLCAnc3VibmV0LTA5MDc5ZGY0M2RhMTYyNmYwJywgJ3N1Ym5ldC0wZWM5N2VjMDI1MDQyMDYxNyddLFxuICAgICAgICAgICAgICAgICAgICAgICAgdnBjSWQ6ICd2cGMtMDJmNjdlZjg5ZDNlNmUwMDInLFxuICAgICAgICAgICAgICAgICAgICAgICAgbXNrQ2x1c3RlckFybjogJ2Fybjphd3M6a2Fma2E6YXAtc291dGhlYXN0LTI6MzE3NTg1NDM1NjQxOmNsdXN0ZXIvYWR2LW1zay1kZXYvMGRiYmJjYTMtMTlkNC00MTBmLWI1ODAtYTFiOTVjZTExYzUzLTInLFxuICAgICAgICAgICAgICAgICAgICAgICAgbXNrQ2x1c3Rlck5hbWU6ICdhZHYtbXNrLWRldicsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYW1iZGFEYXRhZG9nQXBpS2V5U2VjcmV0QXJuOiAnYXJuOmF3czpzZWNyZXRzbWFuYWdlcjphcC1zb3V0aGVhc3QtMjozMTc1ODU0MzU2NDE6c2VjcmV0Oi9kZXYvcGxhdGZvcm0vZGF0YWRvZ19sYW1iZGEta1V4TFd1JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHB1YmxpY0hvc3RlZFpvbmVBdHRyczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvc3RlZFpvbmVJZDogJ1owMjI1ODAzMzc2RjFPTUxXNVNTTycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgem9uZU5hbWU6ICdkZXYub25lcGFzcy5jb20uYXUnXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgYmVuZWZpdHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudEJ1c05hbWU6ICdkZXYtYmVuZWZpdHMnXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICBdKSxcbiAgICAgICAgICAgIHJlc291cmNlUHJlZml4OiAnYWR2YW50YWdlLWFwcC1zYW5kcGl0J1xuICAgICAgICB9XG4gICAgXSxcbiAgICBbXG4gICAgICAgIFdlc2RpZ2l0YWxBY2NvdW50LkFkdmFudGFnZUFwcE5vblByb2QsXG4gICAgICAgIHtcbiAgICAgICAgICAgIGVudkNvbmZpZ3M6IG5ldyBNYXAoW1xuICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgJ3Rlc3QnLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlY3JBY2NvdW50OiBXZXNkaWdpdGFsQWNjb3VudC5DSUNEVG9vbGluZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGludGVybmFsTGI6ICdpbnRlcm5hbC50ZXN0Lm9uZXBhc3MuY29tLmF1JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaXZhdGVTdWJuZXRJZHM6IFsnc3VibmV0LTBlMDdmY2FmNTg5NzBlOTA4JywgJ3N1Ym5ldC0wZDAzZDhkNDc2NGNiMjU2NycsICdzdWJuZXQtMDdmMmM4YWRiNmIyMjk4MTQnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZwY0lkOiAndnBjLTAzYjg3NTk0ZGRjMmM2ZmVhJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1za0NsdXN0ZXJBcm46ICdhcm46YXdzOmthZmthOmFwLXNvdXRoZWFzdC0yOjM0ODI3OTkwMjgzMjpjbHVzdGVyL2Fkdi1tc2stdGVzdC9iYTZmNTdkOC00NDIyLTQ2OWMtOWZjZi0xMWFjNWI5ZmNhOWMtMicsXG4gICAgICAgICAgICAgICAgICAgICAgICBtc2tDbHVzdGVyTmFtZTogJ2Fkdi1tc2stdGVzdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYW1iZGFEYXRhZG9nQXBpS2V5U2VjcmV0QXJuOiAnYXJuOmF3czpzZWNyZXRzbWFuYWdlcjphcC1zb3V0aGVhc3QtMjozNDgyNzk5MDI4MzI6c2VjcmV0Oi90ZXN0L3BsYXRmb3JtL2RhdGFkb2dfbGFtYmRhLXpBR0sxcCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBwdWJsaWNIb3N0ZWRab25lQXR0cnM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBob3N0ZWRab25lSWQ6ICdaMDU5MjM3MzEyNVk1SDNWUzVHU04nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpvbmVOYW1lOiAndGVzdC5vbmVwYXNzLmNvbS5hdSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBiZW5lZml0czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50QnVzTmFtZTogJ3Rlc3QtYmVuZWZpdHMnXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgJ3NpdCcsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVjckFjY291bnQ6IFdlc2RpZ2l0YWxBY2NvdW50LkNJQ0RUb29saW5nLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJuYWxMYjogJ2ludGVybmFsLnNpdC5vbmVwYXNzLmNvbS5hdScsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcml2YXRlU3VibmV0SWRzOiBbJ3N1Ym5ldC0wZTA3ZmNhZjU4OTcwZTkwOCcsICdzdWJuZXQtMGQwM2Q4ZDQ3NjRjYjI1NjcnLCAnc3VibmV0LTA3ZjJjOGFkYjZiMjI5ODE0J10sXG4gICAgICAgICAgICAgICAgICAgICAgICB2cGNJZDogJ3ZwYy0wM2I4NzU5NGRkYzJjNmZlYScsXG4gICAgICAgICAgICAgICAgICAgICAgICBtc2tDbHVzdGVyQXJuOiAnYXJuOmF3czprYWZrYTphcC1zb3V0aGVhc3QtMjozNDgyNzk5MDI4MzI6Y2x1c3Rlci9hZHYtbXNrLXNpdC9hMzNkMzI0NS0xNDgwLTRmODgtYmQyZi01OTJhNDM3YzhhNTItMicsXG4gICAgICAgICAgICAgICAgICAgICAgICBtc2tDbHVzdGVyTmFtZTogJ2Fkdi1tc2stc2l0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhbWJkYURhdGFkb2dBcGlLZXlTZWNyZXRBcm46ICdhcm46YXdzOnNlY3JldHNtYW5hZ2VyOmFwLXNvdXRoZWFzdC0yOjM0ODI3OTkwMjgzMjpzZWNyZXQ6L3NpdC9wbGF0Zm9ybS9kYXRhZG9nX2xhbWJkYS1hSlU2OUsnLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHVibGljSG9zdGVkWm9uZUF0dHJzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9zdGVkWm9uZUlkOiAnWjA1OTE0ODAzS1hUUU9WVFhZRUU1JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB6b25lTmFtZTogJ3NpdC5vbmVwYXNzLmNvbS5hdSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBiZW5lZml0czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50QnVzTmFtZTogJ3NpdC1iZW5lZml0cydcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgIF0pLFxuICAgICAgICAgICAgcmVzb3VyY2VQcmVmaXg6ICdhZHZhbnRhZ2UtYXBwLW5vbnByb2QnXG4gICAgICAgIH1cbiAgICBdLFxuICAgIFtcbiAgICAgICAgV2VzZGlnaXRhbEFjY291bnQuQWR2YW50YWdlQXBwUHJvZCxcbiAgICAgICAge1xuICAgICAgICAgICAgZW52Q29uZmlnczogbmV3IE1hcChbXG4gICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAncHJvZCcsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVjckFjY291bnQ6IFdlc2RpZ2l0YWxBY2NvdW50LkNJQ0RUb29saW5nLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJuYWxMYjogJ2ludGVybmFsLm9uZXBhc3MuY29tLmF1JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaXZhdGVTdWJuZXRJZHM6IFsnc3VibmV0LTA3YWEwZGY3ZGJiYTA0MWYxJywgJ3N1Ym5ldC0wMzIxZGUxM2JjYzg3YTcxNCcsICdzdWJuZXQtMGY1ZjY5ZjcyOGI1YmM5MzInXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZwY0lkOiAndnBjLTA4NDAxZGQ2OWMzZjJiNDEwJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1za0NsdXN0ZXJBcm46ICdhcm46YXdzOmthZmthOmFwLXNvdXRoZWFzdC0yOjU1NDQxNzg0NzU4NDpjbHVzdGVyL2Fkdi1tc2stcHJvZC9iYzI4NDU4MS03ZTA5LTQ1ZjEtOWY4Mi1jNzI1ODM0Nzk5ZjctMicsXG4gICAgICAgICAgICAgICAgICAgICAgICBtc2tDbHVzdGVyTmFtZTogJ2Fkdi1tc2stcHJvZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYW1iZGFEYXRhZG9nQXBpS2V5U2VjcmV0QXJuOiAnYXJuOmF3czpzZWNyZXRzbWFuYWdlcjphcC1zb3V0aGVhc3QtMjo1NTQ0MTc4NDc1ODQ6c2VjcmV0Oi9wcm9kL3BsYXRmb3JtL2RhdGFkb2dfbGFtYmRhLVMwdjVSaScsXG4gICAgICAgICAgICAgICAgICAgICAgICBwdWJsaWNIb3N0ZWRab25lQXR0cnM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBob3N0ZWRab25lSWQ6ICdaMDE0MTA2MjIzT1JVNDhXUTNZMjEnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpvbmVOYW1lOiAnb25lcGFzcy5jb20uYXUnXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgYmVuZWZpdHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudEJ1c05hbWU6ICdwcm9kLWJlbmVmaXRzJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgXSksXG4gICAgICAgICAgICByZXNvdXJjZVByZWZpeDogJ2FkdmFudGFnZS1hcHAtcHJvZCdcbiAgICAgICAgfVxuICAgIF1cbl0pXG5cbmV4cG9ydCBjb25zdCBSZWdpb25BYmJyZXZpYXRpb24gPSB7XG4gICAgJ2FwLXNvdXRoZWFzdC0yJzogJ2Fwc2UyJ1xufVxuXG5leHBvcnQgY29uc3QgQXZhaWxhYmlsaXR5Wm9uZXMgPSB7XG4gICAgJ2FwLXNvdXRoZWFzdC0yJzogWydhcC1zb3V0aGVhc3QtMmEnLCAnYXAtc291dGhlYXN0LTJiJywgJ2FwLXNvdXRoZWFzdC0yYyddXG59XG5cbmV4cG9ydCBjb25zdCB3ZXNEaWdpdGFsVnBjID0gKHNjb3BlOiBDb25zdHJ1Y3QsIGlkOiBzdHJpbmcsIHByb3BzOiBFbnZQcm9wcyk6IElWcGMgPT4ge1xuICAgIGNvbnN0IGVudiA9IHdlc0RpZ2l0YWxFbnYocHJvcHMpXG4gICAgcmV0dXJuIFZwYy5mcm9tVnBjQXR0cmlidXRlcyhzY29wZSwgaWQsIHtcbiAgICAgICAgdnBjSWQ6IGVudi52cGNJZCxcbiAgICAgICAgYXZhaWxhYmlsaXR5Wm9uZXM6IEF2YWlsYWJpbGl0eVpvbmVzW0RlcGxveW1lbnRSZWdpb25dLFxuICAgICAgICBwcml2YXRlU3VibmV0SWRzOiBlbnYucHJpdmF0ZVN1Ym5ldElkc1xuICAgIH0pXG59XG5cbmV4cG9ydCBjb25zdCBwdWJsaWNIb3N0ZWRab25lID0gKHNjb3BlOiBDb25zdHJ1Y3QsIGlkOiBzdHJpbmcsIHByb3BzOiBFbnZQcm9wcyk6IElIb3N0ZWRab25lID0+IHtcbiAgICBjb25zdCBlbnYgPSB3ZXNEaWdpdGFsRW52KHByb3BzKVxuICAgIHJldHVybiBIb3N0ZWRab25lLmZyb21Ib3N0ZWRab25lQXR0cmlidXRlcyhzY29wZSwgaWQsIGVudi5wdWJsaWNIb3N0ZWRab25lQXR0cnMpXG59XG5cbmV4cG9ydCBjb25zdCB3ZXNEaWdpdGFsRW52ID0gKHByb3BzOiBFbnZQcm9wcyk6IEFjY291bnRDb25maWcgPT4ge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tbm9uLW51bGwtYXNzZXJ0aW9uXG4gICAgcmV0dXJuIEF3c0FjY291bnRzLmdldChwcm9wcy5hY2NvdW50KSEuZW52Q29uZmlncy5nZXQocHJvcHMuZW52KSFcbn1cblxuZXhwb3J0IGNvbnN0IGFjY291bnRSZXNvdXJjZVByZWZpeCA9IChhY2NvdW50TnVtYmVyOiBXZXNkaWdpdGFsQWNjb3VudE51bWJlcikgPT4ge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tbm9uLW51bGwtYXNzZXJ0aW9uXG4gICAgcmV0dXJuIEF3c0FjY291bnRzLmdldChhY2NvdW50TnVtYmVyKSEucmVzb3VyY2VQcmVmaXhcbn1cblxuZXhwb3J0IGNvbnN0IGRhdGFkb2dMYW1iZGFOYW1lID0gKGFjY291bnROdW1iZXI6IFdlc2RpZ2l0YWxBY2NvdW50TnVtYmVyKSA9PiB7XG4gICAgcmV0dXJuIGAke2FjY291bnRSZXNvdXJjZVByZWZpeChhY2NvdW50TnVtYmVyKX0tJHtSZWdpb25BYmJyZXZpYXRpb25bRGVwbG95bWVudFJlZ2lvbl19LWRhdGFkb2ctZm9yd2FyZGVyYFxufVxuXG5leHBvcnQgY29uc3QgbGFtYmRhRGF0YWRvZ0FwaUtleVNlY3JldEFybiA9IChwcm9wczogRW52UHJvcHMpOiBzdHJpbmcgPT4ge1xuICAgIHJldHVybiBBd3NBY2NvdW50cy5nZXQocHJvcHMuYWNjb3VudCkhLmVudkNvbmZpZ3MuZ2V0KHByb3BzLmVudikhLmxhbWJkYURhdGFkb2dBcGlLZXlTZWNyZXRBcm5cbn1cblxuZXhwb3J0IGNvbnN0IGRlcGxveWVyUm9sZUFybnMgPSAoc2NvcGU6IENvbnN0cnVjdCkgPT4ge1xuICAgIGNvbnN0IGFjY291bnQgPSBTdGFjay5vZihzY29wZSkuYWNjb3VudFxuICAgIHJldHVybiBbXG4gICAgICAgIGBhcm46YXdzOmlhbTo6JHthY2NvdW50fTpyb2xlL2RhdGEtY3Jvc3NhY2NvdW50LWRlcGxveWVyYCxcbiAgICAgICAgYGFybjphd3M6aWFtOjoke2FjY291bnR9OnJvbGUvYXBwbGljYXRpb24tY3Jvc3NhY2NvdW50LWRlcGxveWVyYCxcbiAgICAgICAgYGFybjphd3M6aWFtOjoke2FjY291bnR9OnJvbGUvZGF0YS1pbmZyYXN0cnVjdHVyZS1jcm9zc2FjY291bnQtZGVwbG95ZXJgLFxuICAgICAgICBgYXJuOmF3czppYW06OiR7YWNjb3VudH06cm9sZS9pbmZyYS1jcm9zc2FjY291bnQtZGVwbG95ZXJgXG4gICAgXVxufVxuIl19