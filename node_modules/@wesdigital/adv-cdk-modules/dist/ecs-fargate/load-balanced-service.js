"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.LoadBalancedService = void 0;
const constructs_1 = require("constructs");
const aws_ecs_patterns_1 = require("aws-cdk-lib/aws-ecs-patterns");
const constructs_2 = require("./constructs");
class LoadBalancedService extends constructs_1.Construct {
    constructor(scope, id, props) {
        super(scope, id);
        const serviceDefinition = new constructs_2.CommonServiceDef(this, 'Definition', {
            fargate: props,
            serviceType: aws_ecs_patterns_1.ApplicationLoadBalancedFargateService
        });
        this._kmsKey = serviceDefinition.kmsKey;
        this._service = serviceDefinition.service;
        this._service.targetGroup.configureHealthCheck(props.albHealthCheck);
    }
    get service() {
        return this._service;
    }
    get loadBalancer() {
        return this._service.loadBalancer;
    }
    get kmsKey() {
        return this._kmsKey;
    }
}
exports.LoadBalancedService = LoadBalancedService;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9hZC1iYWxhbmNlZC1zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vbGliL2Vjcy1mYXJnYXRlL2xvYWQtYmFsYW5jZWQtc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSwyQ0FBc0M7QUFDdEMsbUVBQW9GO0FBSXBGLDZDQUErQztBQVcvQyxNQUFhLG1CQUFvQixTQUFRLHNCQUFTO0lBZ0I5QyxZQUFhLEtBQWdCLEVBQUUsRUFBVSxFQUFFLEtBQXFDO1FBQzVFLEtBQUssQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLENBQUE7UUFFaEIsTUFBTSxpQkFBaUIsR0FBRyxJQUFJLDZCQUFnQixDQUFDLElBQUksRUFBRSxZQUFZLEVBQUU7WUFDL0QsT0FBTyxFQUFFLEtBQUs7WUFDZCxXQUFXLEVBQUUsd0RBQXFDO1NBQ3JELENBQ0EsQ0FBQTtRQUNELElBQUksQ0FBQyxPQUFPLEdBQUcsaUJBQWlCLENBQUMsTUFBTSxDQUFBO1FBQ3ZDLElBQUksQ0FBQyxRQUFRLEdBQUcsaUJBQWlCLENBQUMsT0FBZ0QsQ0FBQTtRQUNsRixJQUFJLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxvQkFBb0IsQ0FBQyxLQUFLLENBQUMsY0FBYyxDQUFDLENBQUE7SUFDeEUsQ0FBQztJQXZCRCxJQUFJLE9BQU87UUFDUCxPQUFPLElBQUksQ0FBQyxRQUFRLENBQUE7SUFDeEIsQ0FBQztJQUVELElBQUksWUFBWTtRQUNaLE9BQU8sSUFBSSxDQUFDLFFBQVEsQ0FBQyxZQUFZLENBQUE7SUFDckMsQ0FBQztJQUVELElBQUksTUFBTTtRQUNOLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQTtJQUN2QixDQUFDO0NBY0o7QUE1QkQsa0RBNEJDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29uc3RydWN0IH0gZnJvbSAnY29uc3RydWN0cydcbmltcG9ydCB7IEFwcGxpY2F0aW9uTG9hZEJhbGFuY2VkRmFyZ2F0ZVNlcnZpY2UgfSBmcm9tICdhd3MtY2RrLWxpYi9hd3MtZWNzLXBhdHRlcm5zJ1xuaW1wb3J0IHsgQXBwbGljYXRpb25Mb2FkQmFsYW5jZXIsIEhlYWx0aENoZWNrIGFzIEFMQkhlYWx0aENoZWNrIH0gZnJvbSAnYXdzLWNkay1saWIvYXdzLWVsYXN0aWNsb2FkYmFsYW5jaW5ndjInXG5pbXBvcnQgeyBLZXkgfSBmcm9tICdhd3MtY2RrLWxpYi9hd3Mta21zJ1xuaW1wb3J0IHsgRmFyZ2F0ZUF1dG9zY2FsaW5nUHJvcHMsIEZhcmdhdGVNb2R1bGVQcm9wcyB9IGZyb20gJy4vcHJvcHMnXG5pbXBvcnQgeyBDb21tb25TZXJ2aWNlRGVmIH0gZnJvbSAnLi9jb25zdHJ1Y3RzJ1xuXG5leHBvcnQgaW50ZXJmYWNlIExvYWRCYWxhbmNlZFNlcnZpY2VBdXRvc2NhbGluZ1Byb3BzIGV4dGVuZHMgRmFyZ2F0ZUF1dG9zY2FsaW5nUHJvcHMge1xuICAgIG1ldHJpYzogJ0NQVScgfCAnUmVxdWVzdHMnIHwgJ01lbW9yeSdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBMb2FkQmFsYW5jZWRTZXJ2aWNlTW9kdWxlUHJvcHMgZXh0ZW5kcyBGYXJnYXRlTW9kdWxlUHJvcHMge1xuICAgIGFsYkhlYWx0aENoZWNrOiBBTEJIZWFsdGhDaGVja1xuICAgIGF1dG9zY2FsaW5nPzogTG9hZEJhbGFuY2VkU2VydmljZUF1dG9zY2FsaW5nUHJvcHNcbn1cblxuZXhwb3J0IGNsYXNzIExvYWRCYWxhbmNlZFNlcnZpY2UgZXh0ZW5kcyBDb25zdHJ1Y3Qge1xuICAgIHByaXZhdGUgcmVhZG9ubHkgX2ttc0tleTogS2V5XG4gICAgcHJpdmF0ZSByZWFkb25seSBfc2VydmljZTogQXBwbGljYXRpb25Mb2FkQmFsYW5jZWRGYXJnYXRlU2VydmljZVxuXG4gICAgZ2V0IHNlcnZpY2UgKCk6IEFwcGxpY2F0aW9uTG9hZEJhbGFuY2VkRmFyZ2F0ZVNlcnZpY2Uge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2VydmljZVxuICAgIH1cblxuICAgIGdldCBsb2FkQmFsYW5jZXIgKCk6IEFwcGxpY2F0aW9uTG9hZEJhbGFuY2VyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NlcnZpY2UubG9hZEJhbGFuY2VyXG4gICAgfVxuXG4gICAgZ2V0IGttc0tleSAoKTogS2V5IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ttc0tleVxuICAgIH1cblxuICAgIGNvbnN0cnVjdG9yIChzY29wZTogQ29uc3RydWN0LCBpZDogc3RyaW5nLCBwcm9wczogTG9hZEJhbGFuY2VkU2VydmljZU1vZHVsZVByb3BzKSB7XG4gICAgICAgIHN1cGVyKHNjb3BlLCBpZClcblxuICAgICAgICBjb25zdCBzZXJ2aWNlRGVmaW5pdGlvbiA9IG5ldyBDb21tb25TZXJ2aWNlRGVmKHRoaXMsICdEZWZpbml0aW9uJywge1xuICAgICAgICAgICAgZmFyZ2F0ZTogcHJvcHMsXG4gICAgICAgICAgICBzZXJ2aWNlVHlwZTogQXBwbGljYXRpb25Mb2FkQmFsYW5jZWRGYXJnYXRlU2VydmljZVxuICAgICAgICB9XG4gICAgICAgIClcbiAgICAgICAgdGhpcy5fa21zS2V5ID0gc2VydmljZURlZmluaXRpb24ua21zS2V5XG4gICAgICAgIHRoaXMuX3NlcnZpY2UgPSBzZXJ2aWNlRGVmaW5pdGlvbi5zZXJ2aWNlIGFzIEFwcGxpY2F0aW9uTG9hZEJhbGFuY2VkRmFyZ2F0ZVNlcnZpY2VcbiAgICAgICAgdGhpcy5fc2VydmljZS50YXJnZXRHcm91cC5jb25maWd1cmVIZWFsdGhDaGVjayhwcm9wcy5hbGJIZWFsdGhDaGVjaylcbiAgICB9XG59XG4iXX0=