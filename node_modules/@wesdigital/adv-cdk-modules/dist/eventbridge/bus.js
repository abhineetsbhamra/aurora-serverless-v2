"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ArchivedEventBridgeBus = void 0;
const constructs_1 = require("constructs");
const aws_events_1 = require("aws-cdk-lib/aws-events");
const aws_cdk_lib_1 = require("aws-cdk-lib");
class ArchivedEventBridgeBus extends constructs_1.Construct {
    constructor(scope, id, props) {
        super(scope, id);
        const eventBusName = `${props.deploymentEnv}-${props.busName}`;
        const bus = new aws_events_1.EventBus(this, 'EventBus', {
            eventBusName
        });
        this._bus = bus;
        bus.archive('Archive', {
            archiveName: `${eventBusName}-archive-all`,
            description: `Archives all events from ${eventBusName}`,
            retention: aws_cdk_lib_1.Duration.days(props.archiveRetentionInDays),
            eventPattern: {
                account: [aws_cdk_lib_1.Stack.of(this).account]
            }
        });
    }
    get bus() {
        return this._bus;
    }
}
exports.ArchivedEventBridgeBus = ArchivedEventBridgeBus;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vbGliL2V2ZW50YnJpZGdlL2J1cy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSwyQ0FBc0M7QUFDdEMsdURBQWlEO0FBRWpELDZDQUE2QztBQVE3QyxNQUFhLHNCQUF1QixTQUFRLHNCQUFTO0lBT2pELFlBQWEsS0FBZ0IsRUFBRSxFQUFVLEVBQUUsS0FBd0M7UUFDL0UsS0FBSyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FBQTtRQUVoQixNQUFNLFlBQVksR0FBRyxHQUFHLEtBQUssQ0FBQyxhQUFhLElBQUksS0FBSyxDQUFDLE9BQU8sRUFBRSxDQUFBO1FBRTlELE1BQU0sR0FBRyxHQUFHLElBQUkscUJBQVEsQ0FBQyxJQUFJLEVBQUUsVUFBVSxFQUFFO1lBQ3ZDLFlBQVk7U0FDZixDQUFDLENBQUE7UUFFRixJQUFJLENBQUMsSUFBSSxHQUFHLEdBQUcsQ0FBQTtRQUVmLEdBQUcsQ0FBQyxPQUFPLENBQUMsU0FBUyxFQUFFO1lBQ25CLFdBQVcsRUFBRSxHQUFHLFlBQVksY0FBYztZQUMxQyxXQUFXLEVBQUUsNEJBQTRCLFlBQVksRUFBRTtZQUN2RCxTQUFTLEVBQUUsc0JBQVEsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLHNCQUFzQixDQUFDO1lBQ3RELFlBQVksRUFBRTtnQkFDVixPQUFPLEVBQUUsQ0FBQyxtQkFBSyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxPQUFPLENBQUM7YUFDcEM7U0FDSixDQUFDLENBQUE7SUFDTixDQUFDO0lBekJELElBQUksR0FBRztRQUNILE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQTtJQUNwQixDQUFDO0NBd0JKO0FBM0JELHdEQTJCQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbnN0cnVjdCB9IGZyb20gJ2NvbnN0cnVjdHMnXG5pbXBvcnQgeyBFdmVudEJ1cyB9IGZyb20gJ2F3cy1jZGstbGliL2F3cy1ldmVudHMnXG5pbXBvcnQgeyBEZXBsb3ltZW50RW52IH0gZnJvbSAnLi4vd2VzZGlnaXRhbCdcbmltcG9ydCB7IER1cmF0aW9uLCBTdGFjayB9IGZyb20gJ2F3cy1jZGstbGliJ1xuXG5leHBvcnQgaW50ZXJmYWNlIEFyY2hpdmVkRXZlbnRCcmlkZ2VCdXNNb2R1bGVQcm9wcyB7XG4gICAgYXJjaGl2ZVJldGVudGlvbkluRGF5czogbnVtYmVyXG4gICAgYnVzTmFtZTogc3RyaW5nXG4gICAgZGVwbG95bWVudEVudjogRGVwbG95bWVudEVudlxufVxuXG5leHBvcnQgY2xhc3MgQXJjaGl2ZWRFdmVudEJyaWRnZUJ1cyBleHRlbmRzIENvbnN0cnVjdCB7XG4gICAgZ2V0IGJ1cyAoKTogRXZlbnRCdXMge1xuICAgICAgICByZXR1cm4gdGhpcy5fYnVzXG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZWFkb25seSBfYnVzOiBFdmVudEJ1c1xuXG4gICAgY29uc3RydWN0b3IgKHNjb3BlOiBDb25zdHJ1Y3QsIGlkOiBzdHJpbmcsIHByb3BzOiBBcmNoaXZlZEV2ZW50QnJpZGdlQnVzTW9kdWxlUHJvcHMpIHtcbiAgICAgICAgc3VwZXIoc2NvcGUsIGlkKVxuXG4gICAgICAgIGNvbnN0IGV2ZW50QnVzTmFtZSA9IGAke3Byb3BzLmRlcGxveW1lbnRFbnZ9LSR7cHJvcHMuYnVzTmFtZX1gXG5cbiAgICAgICAgY29uc3QgYnVzID0gbmV3IEV2ZW50QnVzKHRoaXMsICdFdmVudEJ1cycsIHtcbiAgICAgICAgICAgIGV2ZW50QnVzTmFtZVxuICAgICAgICB9KVxuXG4gICAgICAgIHRoaXMuX2J1cyA9IGJ1c1xuXG4gICAgICAgIGJ1cy5hcmNoaXZlKCdBcmNoaXZlJywge1xuICAgICAgICAgICAgYXJjaGl2ZU5hbWU6IGAke2V2ZW50QnVzTmFtZX0tYXJjaGl2ZS1hbGxgLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IGBBcmNoaXZlcyBhbGwgZXZlbnRzIGZyb20gJHtldmVudEJ1c05hbWV9YCxcbiAgICAgICAgICAgIHJldGVudGlvbjogRHVyYXRpb24uZGF5cyhwcm9wcy5hcmNoaXZlUmV0ZW50aW9uSW5EYXlzKSxcbiAgICAgICAgICAgIGV2ZW50UGF0dGVybjoge1xuICAgICAgICAgICAgICAgIGFjY291bnQ6IFtTdGFjay5vZih0aGlzKS5hY2NvdW50XVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cbn1cbiJdfQ==